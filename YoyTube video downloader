from tkinter import *
from tkinter import ttk
from tkinter import filedialog
from pytube import YouTube
from pytube import Playlist


Folder_Name = ""



# File Location (code)


def openLocation():
    global Folder_Name
    Folder_Name = filedialog.askdirectory()
    if (len(Folder_Name) > 1):
        locationError.config(text = Folder_Name, fg = "green")
    else:
        locationError.config(text = "Please choose Folder !!", fg = "red")
        
        
        
# Downloading The Video (Code)


def DownloadVideo():
    choice = ytdchoices.get()
    url = ytdEntry.get()
    
    if (len(url) > 1):
        ytdError.config(text = "")
        Yt = YouTube(url)
        if (choice == choices[0]):
            select = Yt.streams.filter(progressive = True).first()
    elif (choice == choices[1]):
        select = Yt.streams.filter(progressive = True).second()
    elif (choice == choices[2]):
        select = Yt.streams.filter(progressive = True).last()
    elif (choice == choices[3]):
        select = Yt.streams.filter(only_audio = True).first()
    else:
        ytdError.config(text = "Paste Link Again !!", fg = "red")
        
        
        
        
        
# Download Function



    select.download(Folder_Name)
    ytdError.config(text = "Download Completed !!")        
        
        








root = Tk()
root.title("YtD downloader")
root.geometry("350x400") # Its to set window size
root.columnconfigure(0, weight = 1) # Its set the all contents in center

# YtD link label

ytdLabel= Label(root, text = "Enter the url of the video", font = ("jost",15))
ytdLabel.grid()



# Entry box

ytdEntryVar = StringVar()
ytdEntry = Entry(root, width = 50, textvariable = ytdEntryVar)
ytdEntry.grid()



# Error message


ytdError = Label(root, text = "Error", font = ("jost",10), fg = "red")
ytdError.grid()


# Asking for save path


saveLabel = Label(root, text = "Save the video file", font = ("jost",15,"bold"))
saveLabel.grid()



# BTN for save the file


saveEntry = Button(root, width = 10, bg = "red", fg = "white", text = "Choose Path", command = openLocation)
saveEntry.grid()



# Error message location


locationError = Label(root, text = "Error Path", fg = "red", font = ("jost",10))
locationError.grid()



# Download Quality



ytdQuality = Label(root, text = "Select Download Quality", font = ("jost",15))
ytdQuality.grid()



# Quality Dropdown


choices = ["720p", "360p", "144p", "Only Audio"]
ytdchoices = ttk.Combobox(root, values = choices)
ytdchoices.grid()



# Download BTN



downloadbtn = Button(root, width = 10, text = "Download", bg = "red", fg = "white", command = DownloadVideo)
downloadbtn.grid()



# Developer Label



developerlabel = Label(root, text = "WEB SCORPION", fg = "red", font = ("jost",15,"bold"))
developerlabel.grid()




root.mainloop()
